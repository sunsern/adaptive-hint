<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>

<h1>SockJS Client::Student</h1>

<div>
<button type="button" id="keypressed">'keypressed'</button>
</div>

<div>
<textarea id="textarea" rows="10" cols="80"></textarea>
</div>

<script>
    function append_msg(msg) {
	var textbox = $("#textarea");
	textbox.val(textbox.val() + msg + "\n");
    }

    $(document).ready(function() {
	sock = new SockJS('http://127.0.0.1:4350/student');
	sock.onopen = function() {
	    append_msg("connected");
	    // Send stuent info
	    var randomNum = Math.ceil(Math.random()*10000);
	    sock.send(JSON.stringify({"command": "student_info", 
				      "arguments": {
					  "name": "student" + randomNum,
					  "pg": "setAssignment6/InvisibleOrFly.pg"
				      }}));
	    
	};
	sock.onmessage = function(e) {
	    append_msg("server message: " + e.data);
	};
	sock.onclose = function() {
	    append_msg("disconnected");
	};
	
	$("#keypressed").click(function() {
	    sock.send(JSON.stringify({"command" : "keypressed", 
				      "arguments" : {}}));
	    append_msg("sent 'keypressed'");
	});
	
	append_msg("document loaded");
	
    });  
</script>

</body>
</html>
